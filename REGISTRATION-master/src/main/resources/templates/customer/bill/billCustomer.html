<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AdminLTE 3 | Dashboard</title>

<!-- Google Font: Source Sans Pro -->
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">

<!-- Font Awesome -->
<link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">
<!-- Ionicons -->
<link rel="stylesheet"
	href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
<!-- Tempusdominus Bootstrap 4 -->
<link rel="stylesheet"
	href="plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
<!-- iCheck -->
<link rel="stylesheet"
	href="plugins/icheck-bootstrap/icheck-bootstrap.min.css">
<!-- JQVMap -->
<link rel="stylesheet" href="plugins/jqvmap/jqvmap.min.css">
<!-- Theme style -->
<link rel="stylesheet" href="dist/css/adminlte.min.css">
<!-- overlayScrollbars -->
<link rel="stylesheet"
	href="plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
<!-- Daterange picker -->
<link rel="stylesheet"
	href="plugins/daterangepicker/daterangepicker.css">
<!-- summernote -->
<link rel="stylesheet" href="plugins/summernote/summernote-bs4.min.css">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet"
	href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="plugins/jquery/jquery.min.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="plugins/jquery-ui/jquery-ui.min.js"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
	$.widget.bridge('uibutton', $.ui.button)
</script>
<!-- Bootstrap 4 -->
<script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- ChartJS -->
<script src="plugins/chart.js/Chart.min.js"></script>
<!-- Sparkline -->
<script src="plugins/sparklines/sparkline.js"></script>
<!-- JQVMap -->
<script src="plugins/jqvmap/jquery.vmap.min.js"></script>
<script src="plugins/jqvmap/maps/jquery.vmap.usa.js"></script>
<!-- jQuery Knob Chart -->
<script src="plugins/jquery-knob/jquery.knob.min.js"></script>
<!-- daterangepicker -->
<script src="plugins/moment/moment.min.js"></script>
<script src="plugins/daterangepicker/daterangepicker.js"></script>
<!-- Tempusdominus Bootstrap 4 -->
<script
	src="plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js"></script>
<!-- Summernote -->
<script src="plugins/summernote/summernote-bs4.min.js"></script>
<!-- overlayScrollbars -->
<script
	src="plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
<!-- AdminLTE App -->
<script src="dist/js/adminlte.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="dist/js/demo.js"></script>
<!-- AdminLTE dashboard demo (This is only for demo purposes) -->
<script src="dist/js/pages/dashboard.js"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body class="hold-transition sidebar-mini layout-fixed">
	<div class="wrapper">
		<div
			class="preloader flex-column justify-content-center align-items-center">
			<img class="animation__shake" src="dist/img/AdminLTELogo.png"
				alt="AdminLTELogo" height="60" width="60">
		</div>
		<nav
			class="main-header navbar navbar-expand navbar-white navbar-light">
			<ul class="navbar-nav">
				<li class="nav-item"><a class="nav-link" data-widget="pushmenu"
					href="#" role="button"><i class="fas fa-bars"></i></a></li>
				<li class="nav-item d-none d-sm-inline-block"><a th:href="@{/}"
					class="nav-link">Home</a></li>
				<li class="nav-item d-none d-sm-inline-block"><a href="#"
					class="nav-link">Contact</a></li>
			</ul>
			<ul class="navbar-nav ml-auto">
				<li class="nav-item"><a class="nav-link"
					data-widget="navbar-search" href="#" role="button"> <i
						class="fas fa-search"></i>
				</a>
					<div class="navbar-search-block">
						<form class="form-inline" th:action="@{/searchProduct}"
							method="get">
							<input class="form-control form-control-navbar" type="search"
								placeholder="Search" aria-label="Search" name="productName">
							Chọn mức giá:<input type="number" name="minp"
								class="form-control form-control-navbar" value="0"><span
								style="color: white;"></span> đến <input type="number"
								name="maxp" class="form-control form-control-navbar"
								value="100000000"> Chọn hạng mục: <select
								name="categoryName" required="required">
								<option th:each="category : ${categories}"
									th:text="${category.categoryName}"></option>
							</select>
							<div class="input-group input-group-sm">
								<div class="input-group-append">
									<button class="btn btn-navbar" type="submit">
										<i class="fas fa-search"></i>
									</button>
									<button class="btn btn-navbar" type="button"
										data-widget="navbar-search">
										<i class="fas fa-times"></i>
									</button>
								</div>
							</div>
						</form>
					</div></li>
			</ul>
		</nav>
		<aside class="main-sidebar sidebar-dark-primary elevation-4">
			<a th:href="@{/}" class="brand-link"> <img
				src="dist/img/AdminLTELogo.png" alt="AdminLTE Logo"
				class="brand-image img-circle elevation-3" style="opacity: .8">
				<span class="brand-text font-weight-light">AdminLTE 3</span>
			</a>
			<div class="sidebar">
				<div class="user-panel mt-3 pb-3 mb-3 d-flex" th:object="${user}">
					<div class="image">
						<a href="" data-toggle="modal" data-target="#changeImageModal">
							<img th:src="*{'data:image/jpeg;base64,'+{image}}"
							class="img-circle elevation-2" alt="User Image"
							style="size: 100px;">
						</a>
					</div>
					<div class="info">
						<a href="" class="d-block">[[*{fullName}]]</a>
					</div>
				</div>
				<div class="form-inline">
					<div class="input-group" data-widget="sidebar-search">
						<input class="form-control form-control-sidebar" type="search"
							placeholder="Search" aria-label="Search">
						<div class="input-group-append">
							<button class="btn btn-sidebar">
								<i class="fas fa-search fa-fw"></i>
							</button>
						</div>
					</div>
				</div>
				<nav class="mt-2">
					<ul class="nav nav-pills nav-sidebar flex-column"
						data-widget="treeview" role="menu" data-accordion="false">
						<li class="nav-item menu-close"><a href="#"
							class="nav-link active"> <i
								class="nav-icon fas fa-tachometer-alt"></i> Danh mục <i
								class="right fas fa-angle-left"></i>
						</a></li>
						<li class="nav-header" style="font-weight: bold;" th:if="${role}">SẢN
							PHẨM</li>

						<li class="nav-item" th:if="${role}"><a href=""
							class="nav-link" data-toggle="modal"
							data-target="#addProductModal"> <i
								class="nav-icon fas fa-plus"></i> Thêm sản phẩm

						</a></li>

						<li class="nav-header" style="font-weight: bold;" th:if="${role}">HẠNG
							MỤC</li>
						<li class="nav-item" th:if="${role}"><a
							th:href="@{/listCategories}" class="nav-link"> <i
								class="nav-icon fas fa-list-ul"></i> Danh sách hạng mục

						</a></li>
						<li class="nav-item" th:if="${role}"><a href=""
							class="nav-link" data-toggle="modal"
							data-target="#addCategoryModal"> <i
								class="nav-icon fas fa-plus"></i> Thêm hạng mục

						</a></li>

						<li class="nav-header" style="font-weight: bold;" th:if="${role}">KHÁCH
							HÀNG</li>
						<li class="nav-item" th:if="${role}"><a
							th:href="@{/list_users}" class="nav-link"> <i
								class="nav-icon far fa-calendar-alt"></i> Danh sách khách hàng
						</a></li>
						<li class="nav-item"><a href="#" class="nav-link"
							th:if="${role}"> <i class="nav-icon fas fa-search"></i>

								Search <i class="fas fa-angle-left right"></i>

						</a>
							<ul class="nav nav-treeview">
								<li class="nav-item"><a href="pages/search/simple.html"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										Simple Search
								</a></li>
								<li class="nav-item"><a href="pages/search/enhanced.html"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										Enhanced
								</a></li>
							</ul></li>
						<li class="nav-header" style="font-weight: bold;" th:if="${role}">BÁN
							HÀNG</li>
						<li class="nav-item"><a th:href="@{/listBill}"
							class="nav-link" th:if="${role}"> <i
								class="nav-icon fas fa-list-ul"></i> Lịch sử bán hàng
						</a></li>
						<li class="nav-header" style="font-weight: bold;"
							th:unless="${role}">MUA HÀNG</li>
						<li class="nav-item"><a th:href="@{/listBill}"
							class="nav-link" th:unless="${role}"> <i
								class="nav-icon fas fa-list-ul"></i> Lịch sử mua hàng
						</a></li>
						<li class="nav-header" style="font-weight: bold;">THAO TÁC
							KHÁC</li>
						<li class="nav-item" th:object=${user}><a
							th:href="@{'/edit/'+${user.id}}" class="nav-link"
							data-toggle="modal" data-target="#changeInfoModal"> <i
								class="nav-icon fa fa-info"></i> Sửa thông tin cá nhân
						</a></li>
						<li class="nav-item" th:object=${user}><a href=""
							class="nav-link" data-toggle="modal"
							data-target="#changePasswordModal"> <i
								class="nav-icon fa fa-lock"></i> Đổi mật khẩu
						</a></li>
						<li class="nav-item"><a th:href="@{/logout}" class="nav-link">
								<i class="nav-icon fa fa-sign-out"></i> Đăng xuất
						</a></li>
					</ul>
				</nav>
			</div>
		</aside>
		<div class="content-wrapper">
			<div class="content-header">
				<div class="container-fluid">
					<div class="row mb-2">
						<div class="col-sm-6">
							<h1 class="m-0">Dashboard</h1>
						</div>
						<div class="col-sm-6">
							<ol class="breadcrumb float-sm-right">
								<li class="breadcrumb-item"><a th:href="@{/}">Home</a></li>
								<li class="nav-item" th:unless="${role}"><a
									th:href="@{/cart}" class="nav-link fa fa-shopping-cart"
									style="color: black;"></a></li>
							</ol>
						</div>
					</div>
				</div>
			</div>
			<div class="modal" id="addProductModal" tabindex="-1" role="dialog">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h4 class="modal-title">ADD PRODUCT</h4>
							<button type="button" class="close" data-dismiss="modal">&times;</button>
						</div>
						<div class="modal-body">
							<form class="text-center border border-light p-5"
								th:action="@{/addP}" id="addProductForm" method="post"
								enctype="multipart/form-data">

								<!-- Name -->
								<input type="text" name="name" id="productName"
									class="form-control mb-4" placeholder="Product Name">

								<!-- Price -->
								<input type="number" name="price" id="productPrice"
									class="form-control mb-4" placeholder="Product Price"
									required="required">

								<!-- Description -->
								<input type="text" name="description" id="productDescription"
									class="form-control mb-4" placeholder="Product Description">


								<input type="number" name="number" id="productNumber"
									class="form-control mb-4" placeholder="Product Number">

								<div class="custom-file mb-4">
									<img alt="" src="" style="width: 200px; height: 200px;"
										id="productImage">
									<div></div>
									<input type="file" name="file" id="productFile"
										onchange="ShowImagePreview(this,document.getElementById('productImage'))"
										style="text-align: center;">
								</div>

								<div class="custom-file mb-4">
									<select name="category" required="required"
										id="productCategory">
										<option th:each="category : ${categories}"
											th:value="${category.id}" th:text=${category.categoryName}></option>
									</select>
								</div>
								<button class="btn btn-info btn-block" type="submit"
									id="addProduct">add</button>
							</form>
						</div>
					</div>
				</div>
			</div>
			<div class="modal" id="addCategoryModal" tabindex="-1" role="dialog">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h4 class="modal-title">ADD CATEGORY</h4>
							<button type="button" class="close" data-dismiss="modal">&times;</button>
						</div>
						<div class="modal-body">
							<form class="text-center border border-light p-5" action=""
								method="post" id="addCategoryForm">
								<input type="text" name="categoryName" id="addCategoryName"
									class="form-control mb-4" placeholder="Category Name">

								<button class="btn btn-info btn-block" type="submit"
									id="addCategory">add</button>
							</form>
						</div>
					</div>
				</div>
			</div>
			<div class="modal" id="changeImageModal" tabindex="-1" role="dialog">
				<form th:action="@{/editUserImage}" enctype="multipart/form-data"
					th:object="${user}" method="post">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-body" style="text-align: center;">
								<img alt="" th:src="*{'data:image/jpeg;base64,'+{image}}"
									style="width: 200px; height: 200px;" id="myImage"> <input
									type="file" name="file"
									onchange="ShowImagePreview(this,document.getElementById('myImage'))">
								<button type="submit">Save</button>
							</div>
						</div>
					</div>
				</form>
			</div>
			<div class="modal" id="changeInfoModal" tabindex="-1" role="dialog">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h4 class="modal-title">EDIT USER</h4>
							<button type="button" class="close" data-dismiss="modal">&times;</button>
						</div>
						<div class="modal-body">
							<form th:action="@{/editUser}" method="post"
								enctype="multipart/form-data" th:object="${user}">
								<div class="form-group">
									<input type="text" class="form-control" id="id" name="id"
										th:field="*{id}" style="width: 350px;" hidden="hidden">
								</div>
								<div class="form-group">
									<label for="firstName">FULL NAME:</label> <input type="text"
										class="form-control" id="fullName" name="fullName"
										th:field="*{fullName}" style="width: 350px;"
										required="required">
								</div>
								<div class="form-group">
									<label for="firstName">PHONE NUMBER:</label> <input type="text"
										class="form-control" id="phoneNumber" name="phoneNumber"
										th:field="*{phoneNumber}" style="width: 350px;"
										required="required">
								</div>
								<div class="form-group">
									<label for="address">ADDRESS:</label> <input type="text"
										class="form-control" id=" address" name="address"
										th:field="*{address}" style="width: 350px;"
										required="required">
								</div>
								<button type="submit">SUBMIT</button>

							</form>
						</div>
					</div>
				</div>
			</div>
			<div class="modal" id="changePasswordModal" tabindex="-1"
				role="dialog">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h4 class="modal-title">ĐỔI MẬT KHẨU</h4>
							<button type="button" class="close" data-dismiss="modal">&times;</button>
						</div>
						<div class="modal-body">
							<form th:action="@{/editUserPassword}" method="post"
								enctype="multipart/form-data" th:object="${user}">
								<div class="form-group">
									<input type="text" class="form-control" id="id" name="id"
										th:field="*{id}" style="width: 350px;" hidden="hidden">
								</div>
								<div class="form-group">
									<label for="firstName">MẬT KHẨU MỚI:</label> <input type="text"
										class="form-control" id="password" name="password"
										style="width: 350px;" required="required">
								</div>
								<button type="submit">THAY ĐỔI</button>

							</form>
						</div>
					</div>
				</div>
			</div>
			<section class="content">
				<div class="col-12">
					<hr>
					<table class="table" id="billCustomerTable">
						<thead class="thead-dark">
							<tr>
								<th scope="col">IMAGE</th>
								<th scope="col">NAME</th>
								<th scope="col">QUANTITY</th>
								<th scope="col">PRICE(VND)</th>
								<th scope="col">HOW_TO_PAY</th>
								<th scope="col">BUY_DATE</th>
								<th scope="col">USER'S PHONENUMBER</th>
								<th scope="col">ADDRESS</th>
								<th scope="col">STATUS</th>
								<th scope="col">CANCEL</th>
							</tr>
						</thead>
						<tbody th:each="bill : ${bills}">
							<tr th:id="'row'+${bill.id}">
								<th scope="row"><img alt=""
									th:src="*{'data:image/jpeg;base64,'+{bill.product.image}}"
									style="width: 100px; height: 100px;"></th>
								<td>[[*{bill.product.name}]]</td>
								<td>[[*{bill.quantity}]]</td>
								<td>[[*{bill.toTal}]]</td>
								<td>[[*{bill.howToPay}]]</td>
								<td>[[*{bill.buyDate}]]</td>
								<td>[[*{bill.user.phoneNumber}]]</td>
								<td>[[*{bill.user.address}]]</td>
								<td th:id = "'status'+${bill.id}">[[*{bill.status.statusName}]]</td>
								<td
									th:unless="${bill.status.statusName == 'Hủy đơn'} OR ${bill.status.statusName == 'Giao hàng thành công'} OR ${bill.status.statusName == 'Đang giao hàng'}"><a
									style="color: red;" href="" class="fa fa-times link-cancel"
									th:id="'customerBillStatus'+${bill.id}"
									th:rowNumber="${bill.id}"></a></td>
							</tr>
						</tbody>
					</table>
					<hr>
				</div>
			</section>
		</div>
		<div id="cancel" hidden="hidden">Hủy đơn</div>
		<footer class="main-footer">
			<strong>Copyright &copy; 2014-2021 <a
				href="https://adminlte.io">AdminLTE.io</a>.
			</strong> All rights reserved.
			<div class="float-right d-none d-sm-inline-block">
				<b>Version</b> 3.1.0
			</div>
		</footer>
		<aside class="control-sidebar control-sidebar-dark"></aside>
	</div>
	<script type="text/javascript">
		var contextPath = "[[@{/}]]";
		var csrfHeader = "[[${_csrf.headerName}]]";
		var csrfToken = "[[${_csrf.token}]]";
	</script>
	<script th:src="@{/js/billAction.js}"></script>
	<script th:src="@{/js/add_To_Cart.js}"></script>
	<script th:src="@{/js/checkNumber.js}"></script>
</body>
</html>